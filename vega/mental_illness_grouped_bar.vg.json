{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://raw.githubusercontent.com/google/bard/main/data/mental_health_disorder_share.csv"
  },
  "transform": [
    {
      "type": "filter",
      "expr": "datum.year === 2017"
    },
    {
      "type": "groupby",
      "groupby": ["continent"]
    },
    {
      "type": "aggregate",
      "groupby": ["continent"],
      "aggregates": [
        {
          "op": "mean",
          "field": "schizophrenia",
          "as": "schizophrenia_share"
        },
        {
          "op": "mean",
          "field": "bipolar",
          "as": "bipolar_share"
        },
        {
          "op": "mean",
          "field": "eating",
          "as": "eating_share"
        },
        {
          "op": "mean",
          "field": "anxiety",
          "as": "anxiety_share"
        },
        {
          "op": "mean",
          "field": "drug_use",
          "as": "drug_use_share"
        },
        {
          "op": "mean",
          "field": "depression",
          "as": "depression_share"
        },
        {
          "op": "mean",
          "field": "alcohol_use",
          "as": "alcohol_use_share"
        }
      ]
    },
    {
      "type": "melt",
      "id_vars": ["continent"],
      "value_vars": [
        "schizophrenia_share",
        "bipolar_share",
        "eating_share",
        "anxiety_share",
        "drug_use_share",
        "depression_share",
        "alcohol_use_share"
      ]
    }
  ],
  "mark": "bar",
  "encoding": {
    "x": {
      "field": "variable",
      "type": "nominal"
    },
    "y": {
      "field": "value",
      "type": "quantitative",
      "title": "Share in %"
    },
    "color": {
      "field": "continent",
      "type": "nominal",
      "title": "Continent"
    }
  },
  "config": {
    "mark": {
      "invalid": null
    },
    "axis": {
      "titleFontSize": 18
    },
    "legend": {
      "titleFontSize": 18
    }
  }
}
